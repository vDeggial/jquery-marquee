/**
 * jQuery.marquee - scrolling text like old marquee element
 * @author Original: Aamir Afridi - aamirafridi(at)gmail(dot)com | Current: Deggial
 */
(function(factory){if(typeof define==="function"&&define.amd){define(["jquery"],factory)}else{factory(jQuery)}}(function($){$.fn.marquee=function(options){return this.each(function(){var o=$.extend({},$.fn.marquee.defaults,options),$this=$(this),$marqueeWrapper,containerWidth,containerHeight,animationCss,verticalDir,elWidth,elHeight,loopCount=3,playState="animation-play-state",css3AnimationIsSupported=!1,_prefixedEvent=function(element,type,callback){var pfx=["webkit","moz","MS","o",""];for(var p=0;p<pfx.length;p++){if(!pfx[p])type=type.toLowerCase();element.addEventListener(pfx[p]+type,callback,!1)}},_objToString=function(obj){var tabjson=[];for(var p in obj){if(obj.hasOwnProperty(p)){tabjson.push(p+":"+obj[p])}}
tabjson.push();return"{"+tabjson.join(",")+"}"},_startAnimationWithDelay=function(){$this.timer=setTimeout(animate,o.delayBeforeStart)},methods={pause:function(){if(css3AnimationIsSupported&&o.allowCss3Support){$marqueeWrapper.css(playState,"paused")}else{if($.fn.pause){$marqueeWrapper.pause()}}
$this.data("runningStatus","paused");$this.trigger("paused")},resume:function(){if(css3AnimationIsSupported&&o.allowCss3Support){$marqueeWrapper.css(playState,"running")}else{if($.fn.resume){$marqueeWrapper.resume()}}
$this.data("runningStatus","resumed");$this.trigger("resumed")},toggle:function(){methods[$this.data("runningStatus")==="resumed"?"pause":"resume"]()},destroy:function(){clearTimeout($this.timer);$this.find("*").addBack().off();$this.html($this.find(".js-marquee:first").html())}};var totalWidth=0;$this.children().each(function(){totalWidth+=$(this).outerWidth(!0)});if(typeof options==="string"){if($.isFunction(methods[options])){if(!$marqueeWrapper){$marqueeWrapper=$this.find(".js-marquee-wrapper")}
if($this.data("css3AnimationIsSupported")===!0){css3AnimationIsSupported=!0}
methods[options]()}
return}
var dataAttributes={},attr;$.each(o,function(key){attr=$this.attr("data-"+key);if(typeof attr!=="undefined"){switch(attr){case "true":attr=!0;break;case "false":attr=!1;break}
o[key]=attr}});if(o.speed){o.duration=parseInt($this.width(),10)/o.speed*1000}
verticalDir=o.direction==="up"||o.direction==="down";o.gap=o.duplicated?parseInt(o.gap,10):0;$this.wrapInner("<div class='js-marquee'></div>");var $el=$this.find(".js-marquee").css({"margin-right":o.gap,"float":"left"});totalWidth+=($this.width()+1000);if(o.duplicated){$el.clone(!0).appendTo($this);totalWidth*=2}
$this.wrapInner("<div style='width:"+totalWidth+"px' class='js-marquee-wrapper'></div>");$marqueeWrapper=$this.find(".js-marquee-wrapper");switch(verticalDir)
{case true:containerHeight=$this.height();$marqueeWrapper.removeAttr("style");$this.height(containerHeight);$this.find(".js-marquee").css({"float":"none","margin-bottom":o.gap,"margin-right":0});switch(o.duplicated)
{case true:$this.find(".js-marquee:last").css({"margin-bottom":0});break}
elHeight=$this.find(".js-marquee:first").height()+o.gap;switch(o.startVisible&&!o.duplicated)
{case true:o._completeDuration=((parseInt(elHeight,10)+parseInt(containerHeight,10))/parseInt(containerHeight,10))*o.duration;o.duration=(parseInt(elHeight,10)/parseInt(containerHeight,10))*o.duration;break;case false:o.duration=((parseInt(elHeight,10)+parseInt(containerHeight,10))/parseInt(containerHeight,10))*o.duration;break}
break;case false:elWidth=$this.find(".js-marquee:first").width()+o.gap;containerWidth=$this.width();switch(o.startVisible&&!o.duplicated)
{case true:o._completeDuration=((parseInt(elWidth,10)+parseInt(containerWidth,10))/parseInt(containerWidth,10))*o.duration;o.duration=(parseInt(elWidth,10)/parseInt(containerWidth,10))*o.duration;break;case false:o.duration=((parseInt(elWidth,10)+parseInt(containerWidth,10))/parseInt(containerWidth,10))*o.duration;break}
break}
if(o.duplicated){o.duration=o.duration/2}
if(o.allowCss3Support){var elm=document.body||document.createElement("div"),animationName="marqueeAnimation-"+Math.floor(Math.random()*1e7),domPrefixes="Webkit Moz O ms Khtml".split(" "),animationString="animation",animationCss3Str="",keyframeString="";if(typeof elm.style.animation!=="undefined"){keyframeString="@keyframes "+animationName+" ";css3AnimationIsSupported=!0}
if(css3AnimationIsSupported===!1){for(var i=0;i<domPrefixes.length;i++){if(typeof elm.style[domPrefixes[i]+"AnimationName"]!=="undefined"){var prefix="-"+domPrefixes[i].toLowerCase()+"-";animationString=prefix+animationString;playState=prefix+playState;keyframeString="@"+prefix+"keyframes "+animationName+" ";css3AnimationIsSupported=!0;break}}}
if(css3AnimationIsSupported){animationCss3Str=animationName+" "+o.duration/1000+"s "+o.delayBeforeStart/1000+"s infinite "+o.css3easing;$this.data("css3AnimationIsSupported",!0)}}
var _generateCssData=function(property,value,prefix,suffix)
{prefix=prefix||"";suffix=suffix||"";var data={"property":"","value":""};data.property=property;value=prefix.concat(value,suffix);data.value=value;return data};var _generateAnimationCss=function(value,vertical)
{vertical=vertical||!1;var data=css3AnimationIsSupported?(vertical?_generateCssData("transform",value,"translateY(",")"):_generateCssData("transform",value,"translateX(",")")):(vertical?_generateCssData("margin-top",value):_generateCssData("margin-left",value));var property=data.property;value=data.value;var obj={};obj[property]=value;return obj};var _setElementCss=function(element,value,vertical)
{vertical=vertical||!1;var data=css3AnimationIsSupported?(vertical?_generateCssData("transform",value,"translateY(",")"):_generateCssData("transform",value,"translateX(",")")):(vertical?_generateCssData("margin-top",value):_generateCssData("margin-left",value));element.css(data.property,data.value)};var _adjustAnimation=function()
{if(animationCss3Str)
{animationName=animationName+"0";keyframeString=$.trim(keyframeString)+"0 ";animationCss3Str=animationName+" "+o.duration/1000+"s 0s infinite "+o.css3easing}};var _adjustAnimationDelay=function()
{if(animationCss3Str){animationCss3Str=animationName+" "+o.duration/1000+"s "+o.delayBeforeStart/1000+"s "+o.css3easing}};var _setInfiniteAnimation=function()
{o.duration=o._completeDuration;_adjustAnimation()};var _resetAnimation=function()
{o.duration=o._originalDuration;_adjustAnimation()};var _rePositionVertically=function(){_setElementCss($marqueeWrapper,(o.direction==="up"?containerHeight+"px":"-"+elHeight+"px"),!0)},_rePositionHorizontally=function(){_setElementCss($marqueeWrapper,(o.direction==="left"?containerWidth+"px":"-"+elWidth+"px"))};switch(!0)
{case o.duplicated:var data;var value;switch(verticalDir)
{case true:o.startVisible?_setElementCss($marqueeWrapper,0,!0):_setElementCss($marqueeWrapper,(o.direction==="up"?containerHeight+"px":"-"+((elHeight*2)-o.gap)+"px"),!0);break;default:o.startVisible?_setElementCss($marqueeWrapper,0):_setElementCss($marqueeWrapper,(o.direction==="left"?containerWidth+"px":"-"+((elWidth*2)-o.gap)+"px"));break}
loopCount=o.startVisible?loopCount:1;break;case o.startVisible:loopCount=2;break;default:verticalDir?_rePositionVertically():_rePositionHorizontally();break}
var animate=function(){switch(o.duplicated)
{case true:if(loopCount===1)
{o._originalDuration=o.duration;if(verticalDir)
{o.duration=o.direction==="up"?o.duration+(containerHeight/((elHeight)/o.duration)):o.duration*2}
else{o.duration=o.direction==="left"?o.duration+(containerWidth/((elWidth)/o.duration)):o.duration*2}
if(animationCss3Str){animationCss3Str=animationName+" "+o.duration/1000+"s "+o.delayBeforeStart/1000+"s "+o.css3easing}
loopCount++}
else if(loopCount===2)
{_resetAnimation();loopCount++}
break}
switch(verticalDir)
{case true:switch(!0)
{case o.duplicated:if(loopCount>2){_setElementCss($marqueeWrapper,(o.direction==="up"?0:"-"+elHeight+"px"),!0)}
animationCss=_generateAnimationCss((o.direction==="up"?"-"+elHeight+"px":0),!0);break;case o.startVisible:switch(loopCount)
{case 2:_adjustAnimationDelay();animationCss=_generateAnimationCss((o.direction==="up"?"-"+elHeight+"px":containerHeight+"px"),!0);loopCount++;break;case 3:_setInfiniteAnimation();_rePositionVertically();break}
break;default:_rePositionVertically();animationCss=_generateAnimationCss((o.direction==="up"?"-"+($marqueeWrapper.height())+"px":containerHeight+"px"),!0)}
break;default:switch(!0)
{case o.duplicated:if(loopCount>2){_setElementCss($marqueeWrapper,(o.direction==="left"?0:"-"+elWidth+"px"))}
animationCss=_generateAnimationCss((o.direction==="left"?"-"+elWidth+"px":0));break;case o.startVisible:o.duration=o._originalDuration;switch(loopCount)
{case 2:_adjustAnimationDelay();animationCss=_generateAnimationCss((o.direction==="left"?"-"+elWidth+"px":containerWidth+"px"));loopCount++;break;case 3:_setInfiniteAnimation();_rePositionHorizontally();break}
break;default:_rePositionHorizontally();animationCss=_generateAnimationCss((o.direction==="left"?"-"+elWidth+"px":containerWidth+"px"));break}
break}
$this.trigger("beforeStarting");switch(css3AnimationIsSupported)
{case true:$marqueeWrapper.css(animationString,animationCss3Str);var keyframeCss=keyframeString+" { 100%  "+_objToString(animationCss)+"}",$styles=$marqueeWrapper.find("style");if($styles.length!==0){$styles.filter(":last").html(keyframeCss)}else{$("head").append("<style>"+keyframeCss+"</style>")}
_prefixedEvent($marqueeWrapper[0],"AnimationIteration",function(){$this.trigger("finished")});_prefixedEvent($marqueeWrapper[0],"AnimationEnd",function(){animate();$this.trigger("finished")});break;default:$marqueeWrapper.animate(animationCss,o.duration,o.easing,function(){$this.trigger("finished");if(o.pauseOnCycle){_startAnimationWithDelay()}else{animate()}});break}
$this.data("runningStatus","resumed")};$this.on("pause",methods.pause);$this.on("resume",methods.resume);if(o.pauseOnHover){$this.on("mouseenter",methods.pause);$this.on("mouseleave",methods.resume)}
if(css3AnimationIsSupported&&o.allowCss3Support){animate()}else{_startAnimationWithDelay()}})};$.fn.marquee.defaults={allowCss3Support:!0,css3easing:"linear",easing:"linear",delayBeforeStart:1000,direction:"left",duplicated:!1,duration:5000,speed:0,gap:20,pauseOnCycle:!1,pauseOnHover:!1,startVisible:!1}}));
