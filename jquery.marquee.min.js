/**
 * jQuery.marquee - scrolling text like old marquee element
 * @author Original: Aamir Afridi - aamirafridi(at)gmail(dot)com | Current: Deggial
 */
(function(factory)
{if(typeof define==="function"&&define.amd)
{define(["jquery"],factory)}
else{factory(jQuery)}}(function($)
{$.fn.marquee=function(options)
{return this.each(function()
{var o=$.extend({},$.fn.marquee.defaults,options),data={marquee:{container:{element:null,width:0,height:0},outerWrapper:{element:null,width:0,height:0,animationCss:""},innerWrapper:{element:null,width:0,height:0},animation:{css:"",loopCounter:3,cssPlayState:"animation-play-state",cssAnimationSupport:!1,cssAnimationName:"",cssAnimationString:"animation",cssKeyframeString:""},isVertical:!1}};var marquee=data.marquee;marquee.container.element=$(this);var _prefixedEvent=function(element,type,callback)
{var pfx=["webkit","moz","MS","o",""];for(var p=0;p<pfx.length;p++)
{if(!pfx[parseInt(p)])
{type=type.toLowerCase()}
element.addEventListener(pfx[parseInt(p)]+type,callback,!1)}};var _objToString=function(obj)
{return JSON.stringify(obj).replace(/\"/g,"")};var _startAnimationWithDelay=function()
{marquee.container.element.timer=setTimeout(animate,o.delayBeforeStart)};var methods={pause:function()
{if(marquee.animation.cssAnimationSupport&&o.allowCss3Support)
{marquee.outerWrapper.element.css(marquee.animation.cssPlayState,"paused")}
else{if($.fn.pause)
{marquee.outerWrapper.element.pause()}}
marquee.container.element.data("runningStatus","paused");marquee.container.element.trigger("paused")},resume:function()
{if(marquee.animation.cssAnimationSupport&&o.allowCss3Support)
{marquee.outerWrapper.element.css(marquee.animation.cssPlayState,"running")}
else{if($.fn.resume)
{marquee.outerWrapper.element.resume()}}
marquee.container.element.data("runningStatus","resumed");marquee.container.element.trigger("resumed")},toggle:function()
{methods[marquee.container.element.data("runningStatus")==="resumed"?"pause":"resume"]()},destroy:function()
{clearTimeout(marquee.container.element.timer);marquee.container.element.find("*").addBack().off();marquee.container.element.html(marquee.container.element.find(".js-marquee:first").html())}};var _processDataAttributes=function()
{var attr;$.each(o,function(key)
{attr=marquee.container.element.attr("data-"+key);if(typeof attr!=="undefined")
{switch(attr)
{case "true":attr=!0;break;case "false":attr=!1;break}
o[key]=attr}})};var _initVertical=function()
{marquee.container.height=marquee.container.element.height();marquee.outerWrapper.element.removeAttr("style");marquee.container.element.height(marquee.container.height);marquee.container.element.find(".js-marquee").css({"float":"none","margin-bottom":o.gap,"margin-right":0});switch(o.duplicated)
{case true:marquee.container.element.find(".js-marquee:last").css({"margin-bottom":0});break}
marquee.innerWrapper.height=marquee.container.element.find(".js-marquee:first").height()+o.gap;switch(o.startVisible&&!o.duplicated)
{case true:o._completeDuration=((parseInt(marquee.innerWrapper.height,10)+parseInt(marquee.container.height,10))/parseInt(marquee.container.height,10))*o.duration;o.duration=(parseInt(marquee.innerWrapper.height,10)/parseInt(marquee.container.height,10))*o.duration;break;case false:o.duration=((parseInt(marquee.innerWrapper.height,10)+parseInt(marquee.container.height,10))/parseInt(marquee.container.height,10))*o.duration;break}};var _initHorizontal=function()
{marquee.innerWrapper.width=marquee.container.element.find(".js-marquee:first").width()+o.gap;marquee.container.width=marquee.container.element.width();switch(o.startVisible&&!o.duplicated)
{case true:o._completeDuration=((parseInt(marquee.innerWrapper.width,10)+parseInt(marquee.container.width,10))/parseInt(marquee.container.width,10))*o.duration;o.duration=(parseInt(marquee.innerWrapper.width,10)/parseInt(marquee.container.width,10))*o.duration;break;case false:o.duration=((parseInt(marquee.innerWrapper.width,10)+parseInt(marquee.container.width,10))/parseInt(marquee.container.width,10))*o.duration;break}};var _initCss3Support=function()
{if(o.allowCss3Support)
{var elm=document.body||document.createElement("div");marquee.animation.cssAnimationName="marqueeAnimation-"+Math.floor(Math.random()*1e7);var domPrefixes="Webkit Moz O ms Khtml".split(" ");if(typeof elm.style.animation!=="undefined")
{marquee.animation.cssKeyframeString="@keyframes "+marquee.animation.cssAnimationName+" ";marquee.animation.cssAnimationSupport=!0}
if(marquee.animation.cssAnimationSupport===!1)
{for(var i=0;i<domPrefixes.length;i++)
{if(typeof elm.style[domPrefixes[i]+"marquee.animation.cssAnimationName"]!=="undefined")
{var prefix="-"+domPrefixes[i].toLowerCase()+"-";marquee.animation.cssAnimationString=prefix+marquee.animation.cssAnimationString;marquee.animation.cssPlayState=prefix+marquee.animation.cssPlayState;marquee.animation.cssKeyframeString="@"+prefix+"keyframes "+marquee.animation.cssAnimationName+" ";marquee.animation.cssAnimationSupport=!0;break}}}
if(marquee.animation.cssAnimationSupport)
{marquee.animation.css=marquee.animation.cssAnimationName+" "+o.duration/1000+"s "+o.delayBeforeStart/1000+"s infinite "+o.css3easing;marquee.container.element.data("css3AnimationIsSupported",!0)}}};var _generateCssData=function(property,value,prefix,suffix)
{prefix=prefix||"";suffix=suffix||"";var data={"property":"","value":""};data.property=property;value=prefix.concat(value,suffix);data.value=value;return data};var _generateAnimationCss=function(value,vertical)
{vertical=vertical||!1;var data=marquee.animation.cssAnimationSupport?(vertical?_generateCssData("transform",value,"translateY(",")"):_generateCssData("transform",value,"translateX(",")")):(vertical?_generateCssData("margin-top",value):_generateCssData("margin-left",value));var property=data.property;value=data.value;var obj={};obj[property]=value;return obj};var _setElementCss=function(element,value,vertical)
{vertical=vertical||!1;var data=marquee.animation.cssAnimationSupport?(vertical?_generateCssData("transform",value,"translateY(",")"):_generateCssData("transform",value,"translateX(",")")):(vertical?_generateCssData("margin-top",value):_generateCssData("margin-left",value));element.css(data.property,data.value)};var _adjustAnimation=function()
{if(marquee.animation.css)
{marquee.animation.cssAnimationName=marquee.animation.cssAnimationName+"0";marquee.animation.cssKeyframeString=$.trim(marquee.animation.cssKeyframeString)+"0 ";marquee.animation.css=marquee.animation.cssAnimationName+" "+o.duration/1000+"s 0s infinite "+o.css3easing}};var _adjustAnimationDelay=function()
{if(marquee.animation.css)
{marquee.animation.css=marquee.animation.cssAnimationName+" "+o.duration/1000+"s "+o.delayBeforeStart/1000+"s "+o.css3easing}};var _setInfiniteAnimation=function()
{o.duration=o._completeDuration;_adjustAnimation()};var _resetAnimation=function()
{o.duration=o._originalDuration;_adjustAnimation()};var _rePositionVertically=function()
{_setElementCss(marquee.outerWrapper.element,(o.direction==="up"?marquee.container.height+"px":"-"+marquee.innerWrapper.height+"px"),!0)},_rePositionHorizontally=function()
{_setElementCss(marquee.outerWrapper.element,(o.direction==="left"?marquee.container.width+"px":"-"+marquee.innerWrapper.width+"px"))};var _prepareAnimateDuplicated=function()
{switch(o.duplicated)
{case true:if(marquee.animation.loopCounter===1)
{o._originalDuration=o.duration;if(marquee.isVertical)
{o.duration=o.direction==="up"?o.duration+(marquee.container.height/((marquee.innerWrapper.height)/o.duration)):o.duration*2}
else{o.duration=o.direction==="left"?o.duration+(marquee.container.width/((marquee.innerWrapper.width)/o.duration)):o.duration*2}
if(marquee.animation.css)
{marquee.animation.css=marquee.animation.cssAnimationName+" "+o.duration/1000+"s "+o.delayBeforeStart/1000+"s "+o.css3easing}
marquee.animation.loopCounter++}
else if(marquee.animation.loopCounter===2)
{_resetAnimation();marquee.animation.loopCounter++}
break}};var _prepareAnimateVertical=function()
{switch(!0)
{case o.duplicated:if(marquee.animation.loopCounter>2)
{_setElementCss(marquee.outerWrapper.element,(o.direction==="up"?0:"-"+marquee.innerWrapper.height+"px"),!0)}
marquee.outerWrapper.animationCss=_generateAnimationCss((o.direction==="up"?"-"+marquee.innerWrapper.height+"px":0),!0);break;case o.startVisible:switch(marquee.animation.loopCounter)
{case 2:_adjustAnimationDelay();marquee.outerWrapper.animationCss=_generateAnimationCss((o.direction==="up"?"-"+marquee.innerWrapper.height+"px":marquee.container.height+"px"),!0);marquee.animation.loopCounter++;break;case 3:_setInfiniteAnimation();_rePositionVertically();break}
break;default:_rePositionVertically();marquee.outerWrapper.animationCss=_generateAnimationCss((o.direction==="up"?"-"+(marquee.outerWrapper.element.height())+"px":marquee.container.height+"px"),!0)}};var _prepareAnimateHorizontal=function()
{switch(!0)
{case o.duplicated:if(marquee.animation.loopCounter>2)
{_setElementCss(marquee.outerWrapper.element,(o.direction==="left"?0:"-"+marquee.innerWrapper.width+"px"))}
marquee.outerWrapper.animationCss=_generateAnimationCss((o.direction==="left"?"-"+marquee.innerWrapper.width+"px":0));break;case o.startVisible:o.duration=o._originalDuration;switch(marquee.animation.loopCounter)
{case 2:_adjustAnimationDelay();marquee.outerWrapper.animationCss=_generateAnimationCss((o.direction==="left"?"-"+marquee.innerWrapper.width+"px":marquee.container.width+"px"));marquee.animation.loopCounter++;break;case 3:_setInfiniteAnimation();_rePositionHorizontally();break}
break;default:_rePositionHorizontally();marquee.outerWrapper.animationCss=_generateAnimationCss((o.direction==="left"?"-"+marquee.innerWrapper.width+"px":marquee.container.width+"px"));break}};var _prepareAnimate=function()
{_prepareAnimateDuplicated();switch(marquee.isVertical)
{case true:_prepareAnimateVertical();break;default:_prepareAnimateHorizontal();break}};var _doAnimate=function()
{switch(marquee.animation.cssAnimationSupport)
{case true:marquee.outerWrapper.element.css(marquee.animation.cssAnimationString,marquee.animation.css);var keyframeCss=marquee.animation.cssKeyframeString+" { 100%  "+_objToString(marquee.outerWrapper.animationCss)+"}",$styles=marquee.outerWrapper.element.find("style");if($styles.length!==0)
{$styles.filter(":last").html(keyframeCss)}
else{$("head").append("<style>"+keyframeCss+"</style>")}
_prefixedEvent(marquee.outerWrapper.element[0],"AnimationIteration",function()
{marquee.container.element.trigger("finished")});_prefixedEvent(marquee.outerWrapper.element[0],"AnimationEnd",function()
{animate();marquee.container.element.trigger("finished")});break;default:marquee.outerWrapper.element.animate(marquee.outerWrapper.animationCss,o.duration,o.easing,function()
{marquee.container.element.trigger("finished");if(o.pauseOnCycle)
{_startAnimationWithDelay()}
else{animate()}});break}};var animate=function()
{_prepareAnimate();marquee.container.element.trigger("beforeStarting");_doAnimate();marquee.container.element.data("runningStatus","resumed")};var _init=function()
{var totalWidth=0;marquee.container.element.children().each(function()
{totalWidth+=marquee.container.element.outerWidth(!0)});_processDataAttributes();if(o.speed)
{o.duration=parseInt(marquee.container.element.width(),10)/o.speed*1000}
marquee.isVertical=o.direction==="up"||o.direction==="down";o.gap=o.duplicated?parseInt(o.gap,10):0;marquee.container.element.wrapInner("<div class='js-marquee'></div>");var $el=marquee.container.element.find(".js-marquee").css({"margin-right":o.gap,"float":"left"});totalWidth+=(marquee.container.element.width()+1000);if(o.duplicated)
{$el.clone(!0).appendTo(marquee.container.element);totalWidth*=2}
marquee.container.element.wrapInner("<div style='width:"+totalWidth+"px' class='js-marquee-wrapper'></div>");marquee.outerWrapper.element=marquee.container.element.find(".js-marquee-wrapper");marquee.outerWrapper.element.css("will-change","transform");switch(marquee.isVertical)
{case true:_initVertical();break;case false:_initHorizontal();break}
if(o.duplicated)
{o.duration=o.duration/2}
_initCss3Support();switch(!0)
{case o.duplicated:switch(marquee.isVertical)
{case true:o.startVisible?_setElementCss(marquee.outerWrapper.element,0,!0):_setElementCss(marquee.outerWrapper.element,(o.direction==="up"?marquee.container.height+"px":"-"+((marquee.innerWrapper.height*2)-o.gap)+"px"),!0);break;default:o.startVisible?_setElementCss(marquee.outerWrapper.element,0):_setElementCss(marquee.outerWrapper.element,(o.direction==="left"?marquee.container.width+"px":"-"+((marquee.innerWrapper.width*2)-o.gap)+"px"));break}
marquee.animation.loopCounter=o.startVisible?marquee.animation.loopCounter:1;break;case o.startVisible:marquee.animation.loopCounter=2;break;default:marquee.isVertical?_rePositionVertically():_rePositionHorizontally();break}};if(typeof options==="string")
{if($.isFunction(methods[options]))
{if(!marquee.outerWrapper.element)
{marquee.outerWrapper.element=marquee.container.element.find(".js-marquee-wrapper")}
if(marquee.container.element.data("css3AnimationIsSupported")===!0)
{marquee.animation.cssAnimationSupport=!0}
methods[options]()}
return}
_init();marquee.container.element.on("pause",methods.pause);marquee.container.element.on("resume",methods.resume);if(o.pauseOnHover)
{marquee.container.element.on("mouseenter",methods.pause);marquee.container.element.on("mouseleave",methods.resume)}
if(marquee.animation.cssAnimationSupport&&o.allowCss3Support)
{animate()}
else{_startAnimationWithDelay()}})};$.fn.marquee.defaults={allowCss3Support:!0,css3easing:"linear",easing:"linear",delayBeforeStart:1000,direction:"left",duplicated:!1,duration:5000,speed:0,gap:20,pauseOnCycle:!1,pauseOnHover:!1,startVisible:!1}}));
